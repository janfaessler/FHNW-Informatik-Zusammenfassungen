\documentclass[a4paper,10pt]{article}

%Math
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{ulem}
\usepackage{stmaryrd} %f\UTF{00FC}r Blitz!

%PageStyle
\usepackage[ngerman]{babel}
\usepackage[latin1]{inputenc}
\usepackage{fontenc}
\usepackage{fancyhdr, graphicx}
\usepackage{wasysym}
\usepackage{fullpage}
\usepackage{textcomp}
\usepackage{fancyhdr} %for header/footer

%My Commands
\newcommand{\BN}{\mathbb{B}} %BOOL
\newcommand{\RN}{\mathbb{R}} %Real Number
\newcommand{\NN}{\mathbb{N}} %Natural Number
\newcommand{\QN}{\mathbb{Q}} %Rational Number
\newcommand{\ZN}{\mathbb{Z}} %ganze Zahlen
\newcommand{\CN}{\mathbb{C}}
\newcommand{\Teilt}{\mid} %|
\newcommand{\Teiltn}{\nmid} %kein teiler
\newcommand{\Potp}{\mathcal{P}} %Potenzmenge
\newcommand{\Pota}{\mathcal{A}}
\newcommand{\Potr}{\mathcal{R}}
\newcommand{\Potn}{\mathcal{N}}
\newcommand{\Bold}[1]{\textbf{#1}} %Boldface
\newcommand{\Kursiv}[1]{\textit{#1}} %Italic
\newcommand{\T}[1]{\text{#1}} %Textmode
\newcommand{\Nicht}[1]{\T{\sout{$ #1 $}}} %Streicht Shit durch
\newcommand{\lra}{\leftrightarrow} %Arrows
\newcommand{\ra}{\rightarrow}
\newcommand{\la}{\leftarrow}
\newcommand{\lral}{\longleftrightarrow}
\newcommand{\ral}{\longrightarrow}
\newcommand{\lal}{\longleftarrow}
\newcommand{\Lra}{\Leftrightarrow}
\newcommand{\Ra}{\Rightarrow}
\newcommand{\La}{\Leftarrow}
\newcommand{\Lral}{\Longleftrightarrow}
\newcommand{\Ral}{\Longrightarrow}
\newcommand{\Lal}{\Longleftarrow}
\newcommand{\Vektor}[1]{\vec{#1}}
\newcommand{\Brace}[1]{\left( #1 \right)} %()
\newcommand{\Bracel}[1]{\left\lbrace #1 \right.} %(
\newcommand{\Bracer}[1]{\right. #1 \right\rbrace} %)
\newcommand{\Brack}[1]{\left\lbrace #1 \right\rbrace} %{}
\newcommand{\Brackl}[1]{\left\lbrace #1 \right.} %{
\newcommand{\Brackr}[1]{\right. #1 \right\rbrace} %}
\newcommand{\Result}[1]{\underline{\underline{#1}}} %Doppelt unterstrichen
\newcommand{\Abs}[1]{\left| #1 \right|} %Absolutbetrag
\newcommand{\Norm}[1]{\Abs{\Abs{ #1 }}} %Norm
\newcommand{\Arrays}[1]{\left(\begin{array}{c}#1\end{array}\right)} %Array mit einer Kolonne ()
\newcommand{\Array}[2]{\left(\begin{array}{#1}#2\end{array}\right)} %Array mit n Kolonnen ()
\newcommand{\Bracka}[2]{\left\lbrace\begin{array}{#1}#2\end{array}\right\rbrace} %Array mit {}
\newcommand{\Brackal}[2]{\left\lbrace\begin{array}{#1} #2 \end{array}\right.} %Array mit {
\newcommand{\Brackar}[2]{\left.\begin{array}{#1} #2 \end{array}\right\rbrace} %Array mit }
\newcommand{\Sumone}[2]{\sum_{#2=1}^{#1}} %Summe von 1
\newcommand{\Sumz}[2]{\sum_{#2=0}^{#1}} %Summe von 0
\newcommand{\Sum}[2]{\sum_{#2}^{#1}} %Allgemeine Summe
\newcommand{\Oneover}[1]{\frac{1}{#1}} %1 \UTF{00FC}ber igendwas
\newcommand{\Tablewt}[3]{\begin{table*}[h]\caption{#1} \begin{tabular}{#2}{#3}\end{tabular}\end{table*}} %Table mit Titel
\newcommand{\Oben}[2]{\overset{#1}{#2}} %etwas \UTF{00FC}ber etwas anderem
\newcommand{\Unten}[2]{\underset{#1}{#2}} %etwas unter etwas anderem
\newcommand{\Bildcap}[2]{\begin{figure}[htb]\centering\includegraphics[width=0.2\textwidth]{#1} \caption{#2}\end{figure}} %Bild mit beschriftung
\newcommand{\Bildjpeg}[1]{\includegraphics[width=0.2\textwidth]{#1.jpeg}} %Bilder jpeg!!
\newcommand{\Bildjpg}[1]{\includegraphics[width=0.2\textwidth]{#1.jpg}} %Bilder jpg!!

%Zeichnung
\usepackage{tikz}
\usepackage[all]{xy}
\usepackage{ucs}

\definecolor{dkgreen}{rgb}{0,0.6,0}
\definecolor{gray}{rgb}{0.5,0.5,0.5}
\definecolor{mauve}{rgb}{0.58,0,0.82}

\usepackage{color}
\usepackage{xcolor}
\usepackage{listings}

\usepackage{caption}
\DeclareCaptionFont{white}{\color{white}}
\DeclareCaptionFormat{listing}{\colorbox{gray}{\parbox{\textwidth}{#1#2#3}}}
\captionsetup[lstlisting]{format=listing,labelfont=white,textfont=white}
 
\lstdefinestyle{MyAntStyle}{  %\lstset{ %
  language=Octave,                % the language of the code
  basicstyle=\footnotesize,           % the size of the fonts that are used for the code
  numbers=left,                   % where to put the line-numbers
  numberstyle=\tiny\color{black},  % the style that is used for the line-numbers
  stepnumber=1,                   % the step between two line-numbers. If it's 1, each line 
                                  % will be numbered
  numbersep=3pt,                  % how far the line-numbers are from the code
  frame=b,         
  backgroundcolor=\color{white},      % choose the background color. You must add \usepackage{color}
  showspaces=false,               % show spaces adding particular underscores
  showstringspaces=false,         % underline spaces within strings
  showtabs=false,                 % show tabs within strings adding particular underscores
  tabsize=2,                      % sets default tabsize to 2 spaces
  breaklines=true,                % sets automatic line breaking
  breakatwhitespace=false,        % sets if automatic breaks should only happen at whitespace
  keywordstyle=\color{blue},          % keyword style
  commentstyle=\color{black},       % comment style
  stringstyle=\color{mauve},         % string literal style
  xleftmargin=17pt,		
  framexleftmargin=17pt,
  framexrightmargin=5pt,
  framexbottommargin=4pt,
  morekeywords={int,long,float,public,static,class}               % if you want to add more keywords to the set
}

\lstdefinestyle{MyJavaStyle}{ %\lstset{
 language=Java,
 basicstyle=\footnotesize\ttfamily, % Standardschrift
 numbers=left,               % Ort der Zeilennummern
 numberstyle=\tiny,          % Stil der Zeilennummern
 %stepnumber=2,               % Abstand zwischen den Zeilennummern
 numbersep=5pt,              % Abstand der Nummern zum Text
 tabsize=2,                  % Groesse von Tabs
 extendedchars=true,         %
 breaklines=true,            % Zeilen werden Umgebrochen
% keywordstyle=\color{red},
 frame=b,         
 stringstyle=\color{white}\ttfamily, % Farbe der String
 showspaces=false,           % Leerzeichen anzeigen ?
 showtabs=false,             % Tabs anzeigen ?
 xleftmargin=17pt,
 framexleftmargin=17pt,
 framexrightmargin=5pt,
 framexbottommargin=4pt,
 showstringspaces=false      % Leerzeichen in Strings anzeigen ?        
}

%Config
\renewcommand{\headrulewidth}{0pt}
\setlength{\headheight}{15.2pt}
\pagestyle{plain}

%Metadata
\title{Software-Konstruktion}
\author{Jan Fässler, Fabio Oesch \& Fabian Stebler}
\date{2. Semester (FS 2012)}
\fancyfoot[C]{If you use this documentation for a exam, you should offer a beer to the authors!}

\begin{document}
\maketitle
\thispagestyle{fancy} %f\UTF{00FC}r Header

\newpage
\section{Grundlagen der SW-Konstruktion}
\subsection{Grundlagende Komponenten:}
\begin{itemize}
 \item Coding und Debugging
 \item Detailliertes Design
 \item Construction Planning
 \item Unit Testing
 \item Integration
 \item Integration Testing
\end{itemize}
\subsection{SW-Konstruktion (Def)}
Fundamentaler Akt des Software-Engineerings: Das Erstellen von funktionalem und bedeutungsvoller Software durch eine Kombination von Coding, Validation und Testing.

\subsection{Qualität einer Software}
\begin{itemize}
 \item Reliability (Fehlerfrei)
 \item Reusability (Spätere Verwendung)
 \item Extendibility (Erweiterung)
 \item Understandability (u.a. Wartung)
 \item Efficiency 
 \item Usability
 \item Testability
 \item Portability (SW übertragen)
 \item Functionality
\end{itemize}

\subsection{Aufbau einer Umgebung für SW-Konstruktion}
\begin{center}
 \includegraphics[scale=1.2]{umgebung_sw_konstruktion.png}
\end{center}
\pagebreak

\section{Konfigurations- und Versionsmanagement}
\subsection{Symptome von einem schlechten Versionsmanagement}
\begin{itemize}
 \item Alte Bugs tauchen wieder auf
 \item Alte Releases können nicht gebuildet werden
 \item Alte Releases können nicht gefunden werden
 \item Dateien gehen verloren
 \item Dateien sind plötzlich verändert
 \item Der selbe Code existiert in mehreren Projekten
 \item Zwei Entwickler arbeiten an Datei
\end{itemize}

\subsection{Versionsmanagement der Dateien}
\begin{tabular}{ll}
 \Bold{unter Versionsmanagement}&\Bold{nicht unter Versionsmanagement}\\
 $\bullet$ Sourcecode&$\bullet$ Alle generierten Dateien\\
 $\bullet$ Sourcefiles&$\bullet$ Generierte Javadoc\\
 $\bullet$ Konfigurationsdateien&$\bullet$ Binaries\\
 $\bullet$ Properties&$\bullet$ Log-Dateien\\
 $\bullet$ Build Files&$\bullet$ Testergebnisse\\
 $\bullet$ Ressourcen Files&\\
 $\bullet$ Benutzer-Doku&\\
\end{tabular}

\subsection{Versionsmanagement}
\begin{itemize}
 \item Repository: Datenbank, alle Dateien abgespeichert
 \item Working copy: Lokale Kopie
 \item Checkout: repo $\ra$ working copy
 \item Commit: working copy $\ra$ repo
 \item Update: Inline-Update
 \item Tagging: Snapshots vom Code\\
\includegraphics{tagging.png}
 \item Braching: Alternative Development-Version\\
\includegraphics{branching.png}
\end{itemize}

\subsection{Bestandteile eines Konfigurationsmanagement}
\begin{itemize}
 \item Versions- und Releasemanagement
 \item Systembuilding (Tools wie ANT)
 \item Änderungsmanagement
 \item Planung von Konfigurationsmanagement
\end{itemize}

\subsection{Nummerierung von Revisionen}
\begin{enumerate}
 \item checkout
\begin{itemize}
 \item src/Main.java: 4
 \item src/Class.java: 4
 \item build/build.xml: 4
\end{itemize}
 \item Edit build.xml
\begin{itemize}
 \item src/Main.java: 4
 \item src/Class.java: 4
 \item build/build.xml: 8
\end{itemize}
 \item update
\begin{itemize}
 \item src/Main.java: 11
 \item src/Class.java: 11
 \item build/build.xml: 11
\end{itemize}
\end{enumerate}

\subsection{Merging}
\includegraphics{merging.png}


\pagebreak
\section{Build Automation}
\subsection{Anforderungen für Build-Automation}
\begin{itemize}
 \item Build Server
 \item Versionsmanagement
 \item Tools
 \item Vor Ende des Tages eingecheckter Code
 \item Build-fähiger Code
 \item Unit-Tests
\end{itemize}

\subsection{Visualisierung Build-Automation}
\includegraphics[scale=0.6]{build_automation.png}

\subsection{CRISP Builds}
\begin{itemize}
	\item[\Bold {Complete}] Alle dazugehörigen Ressourcen inbegriffen
	\item[\Bold {Repeatable}] Beliebig vielmal wiederholbar
	\item[\Bold {Informative}] Stellt wichtige Informationen bereit
	\item[\Bold {Schedulable}] Komplett und wiederholbar
	\item[\Bold {Portable}] Unabhängig von Maschine
\end{itemize}

\subsection{Ant-Script}
\lstinputlisting[language=Octave, label=Ant script, caption=Ant Script 1,style=MyAntStyle]{ant-script.xml}
\begin{lstlisting}[language=Octave, label=Ant script, caption=Ant Script 2a, style=MyAntStyle]
<target name="junitreport">
    <junitreport todir="${report.dir}">
        <fileset dir="${report.dir}" includes="TEST-*.xml"/>
        <report todir="${report.dir}"/>
    </junitreport>
</target>
\end{lstlisting}
\begin{lstlisting}[language=Octave, label=Ant script, caption=Ant Script 2b, style=MyAntStyle]
<path id="application" location="${jar.dir}/${ant.project.name}.jar"/>
<target name="run" depends="jar">
    <java fork="true" classname="${main-class}">
        <classpath>
            <path refid="classpath"/>
            <path refid="application"/>
        </classpath>
    </java>
</target>
\end{lstlisting}
\begin{lstlisting}[language=Octave, label=Ant script, caption=Ant Script 2c, style=MyAntStyle]
 <project name="MyProject" default="dist" basedir=".">
    <description>
        simple example build file
    </description>
  <!-- set global properties for this build -->
  <property name="src" location="src"/>
  <property name="build" location="build"/>
  <property name="dist"  location="dist"/>

  <target name="init">
    <!-- Create the time stamp -->
    <tstamp/>
    <!-- Create the build directory structure used by compile -->
    <mkdir dir="${build}"/>
  </target>

  <target name="compile" depends="init"
        description="compile the source " >
    <!-- Compile the java code from ${src} into ${build} -->
    <javac srcdir="${src}" destdir="${build}"/>
  </target>

  <target name="dist" depends="compile"
        description="generate the distribution" >
    <!-- Create the distribution directory -->
    <mkdir dir="${dist}/lib"/>

    <!-- Put everything in ${build} into the MyProject-${DSTAMP}.jar file -->
    <jar jarfile="${dist}/lib/MyProject-${DSTAMP}.jar" basedir="${build}"/>
  </target>

  <target name="clean"
        description="clean up" >
    <!-- Delete the ${build} and ${dist} directory trees -->
    <delete dir="${build}"/>
    <delete dir="${dist}$"/>
  </target>
</project>
\end{lstlisting}


\newpage
\section{Continuous Integration}
\includegraphics[scale=0.8]{continuous_integration.png}
\subsection{Nutzen}
\begin{itemize}
 \item Vereinfachte Zusammenarbeit im Team
 \item Komplexe Systeme werden besser kontrollier und verwaltbar
 \item Reduziertes Risiko
 \item Module werden gezwungen, zusammenzuarbeiten
 \item Automatisches compile, run, testing und deploy
 \item Frühes Identifizieren von Problemen
 \item Immer einen auslieferbaren Build haben
 \item Immer Klarheit über den Status des Projekts haben
 \item Weniger Zeit in Anspruch genommen um Fehler zu finden
 \item Weniger Zeit verschwendet wegen 'broken code'
 \item Codequalität verbessern mit hinzugefügten Tasks
 \item Potenzielle Deploymentprobleme frühzeitig feststellen
\end{itemize}

\subsection{Hindernisse}
\begin{itemize}
 \item Potenziell ein bereits vorhandenes Projekt in ein CI zu importieren
 \item Systeme die Serverkomponenten benutzen
 \item DB-basierte Systeme müssen up-to-date sein
\end{itemize}


\subsection{Integration ist defekt wenn...}
\begin{itemize}
 \item Der Build nicht erfolgreich ist
 \item Gesharte Komponenten nicht überall gleich funktionieren 
 \item Unit-Tests nicht erfolgreich sind
 \item Die Code-Qualität schlecht (Conventions, Metrics) ist
 \item Das Deployment nicht erfolgreich ist
\end{itemize}

\subsection{Anwendung von CI}
\begin{itemize}
 \item Ein einzelnes Code-Repo
 \item Build automatisieren
 \item Build testet automatisch
 \item Jeder Developer committet jeden Tag
 \item Jeder Commit sollte volle CI ausführen
 \item Testen in Klon von produktiver Umgebung
 \item Jeder hat den Überblick
 \item Automatisches Deployment
 \item Keep the build fast
 \item Jeder kann die neueste Version leicht erhalten
\end{itemize}

\subsection{Agiler Prozess}
\begin{itemize}
 \item Iterative Releases
 \item Planen von Builds
 \item Inkrementelles Implementieren
 \item Task für Task implementieren und immer wieder refactoring betreiben
 \item Report
 \item Output von CI ernst nehmen und bei Fehler Report
\end{itemize}

\subsection{Jenkins}
\begin{itemize}
 \item Continuous Integration Server
 \item Building, Testing, Code Coverage, Analyse, ...
 \item Detaillierter Output
 \item Schneller Überblick über Builds
 \item Dashboard praktisch für mehre Projekte
 \item Viele Plugins
\end{itemize}

\pagebreak
\section{Unit Testing}

\subsection{Aspekte des Testings}
\begin{itemize}
 \item[\Bold {Validation:}] 			Ist das Produkt überhaupt das, was gewünscht wurde? 
 \item[\Bold {Verifikation:}]			Ist das Produkt korrekt programmiert?
 \item[\Bold {Regression:}]				Iteratives Wiederholen von Tests 
 \item[\Bold {Software Fault:}]		Bug im Code
 \item[\Bold {Software Error:}]		Zustand der beim Ausführen von verbuggtem Code auftritt (z.B. nicht abgefangene Exception)
 \item[\Bold {Software Failure:}] Software verhält sich nicht wie erwartet (Requirements nicht erfüllt oder Bugs)
\end{itemize}

\subsection{Der Testprozess}
\includegraphics[scale=0.75]{unit_test.png}

\subsection{Gute Tests}
\begin{itemize}
	\item[\Bold {Automatic}] 		Tests ausführen und Resultate überprüfen
	\item[\Bold {Thorough}] 		Alles was Fehlschlagen kann testen $\Ra$ Code Coverage
	\item[\Bold {Repeatable}] 	Der Test ist beliebig oft wiederholbar; wird am Code nichts geändert, bleibt das Resultat dasselbe
	\item[\Bold {Independent}]	Tests hängen nicht voneinander ab
	\item[\Bold {Professional}] Gleichen professionellen Standard wie für den Code benutzen
\end{itemize}

\subsection{Testdaten}
\subsubsection{Bestimmen von Testwerten:}
Für die Rechnung $\sqrt{(X-1)\cdot(X+2)}\to$ Testet man die folgenden Fälle:
\begin{description}
\item[EC1] $X<=-2\to$ Valid
\item[EC2] $-2<X<1\to$ Invalid
\item[EC3] $X>=1\to$ Valid
\end{description}
Auch immer wichtig: Werte wie MAX\_$ $VALUE und MIN\_$ $VALUE nicht ausser Acht lassen
\subsubsection{Right-BICEP Testliste für Tests}
\begin{description}
\item [Right] Sind die Resultate richtig?
\item [B] Sind Randbedingungen (Boundaries) eingehalten worden?
\item [I] Können inverse Beziehungen überprüft werden? (Funktion mit Gegenfunktion überprüfen, z.B. INSERT und DELETE)
\item [C] Sind die Resultate mit anderen Mittel cross-checked?
\item [E] Ist es möglich, Error Conditions zu erzwingen?
\item [P] Stimmt die Performance?
\end{description}

\subsection{Testklasse}
Die Testklasse ist für das Testen eines Elements verantwortlich
\begin{itemize}
	\item Deswegen ist normalerweise eine Testklasse zum Testen einer einzigen Klasse zuständig
	\item Eine Testklasse ist eine normale Java-Klasse.
	\item Falls die Testklasse im gleichen Package wie die zu testende Klasse ist, kann sie auf die default und protected Methoden zugreifen. Die Testklassen sollten nicht im gleichen Source-Verzeichnis sein wie die zu testende Klassen.
\end{itemize}

\subsection{Begriffserklärung}
\begin{tabular}{lll}
CUT&\Bold {Class under Test}&Die zu testende Klasse\\
MUT&\Bold {Method under Test}&Die zu testende Methode\\
&\Bold {Test Case}&Spezifizierte Daten, um Methoden von CUT zu testen\\
&\Bold {Test Suite}&Mehrere Test Cases, für ein bestimmtes Ziel zuständig\\
&\Bold {Test Fixture}&Beispielsweise eine JUnit-Testklasse\\
\end{tabular}\\ \\
\includegraphics[scale=1]{Begriffe.png}

\subsection{HowTo}
\subsubsection{Setup}
Um einen Test zu initialisieren wird eine Setup-Methode vor jeder Testmethode aufgerufen
\begin{itemize}
	\item In der Setup-Methode die Testumgebung wird initialisiert
	\item Die Setup-Methode garantiert, dass jede Testmethode mit der gleichen Umgebung stattfindet
	\item Eine Setup-Methode muss 'public void' und mit @Before notiert sein 
\end{itemize}
\begin{lstlisting}[language=Java,caption=Unit Test (Before), style=MyJavaStyle]
@Before
public void setup() {
	... 
}
\end{lstlisting}

\subsubsection{Testmethode}
Eine Unittest Klasse besteht aus mehreren verschiedenen Testmethoden
\begin{itemize}
	\item Tests bekommen kein Argument und geben nichts zurück
	\item Jede Testmethode sollte komplett unabhängig von anderen Testmethoden sein
	\item Meistens testet eine einzelne Testklasse eine individuelle Methode von der zu testenden Klasse
	\item Eine Testmethode muss 'public void' und mit @Test notiert sein
\end{itemize}
\begin{lstlisting}[language=Java,caption=Unit Test (Test), style=MyJavaStyle]
@Test
public void testY() {
	... 
}
\end{lstlisting}

\subsubsection{Teardown}
Nach jeder Testmethode wird eine Teardown-Methode aufgerufen
\begin{itemize}
	\item Die Teardown-Methode bringt alles wieder auf den Ursprungszustand
	\item So sind alle Resultate separat und werden nicht von anderen Tests verfälscht
	\item Eine Testmethode muss 'public void' und mit @After notiert sein
\end{itemize}
\begin{lstlisting}[language=Java,caption=Unit Test (After), style=MyJavaStyle]
@After
public void teardown() {
	... 
}
\end{lstlisting}

\subsubsection{Assertions}
Assertions werden zum Vergleichen von erwarteten Resultaten genutzt.
\begin{description}
	\item[assertEquals($<Type>$ expected, $<Type>$ actual)] \hfill
		\begin{itemize}
			\item Vergleicht primitive Typen am Wert
			\item Vergleicht Klassen-basierte Typen mit dem Aufruf equals
			\item Überladen mit allen primitiven Typen, Objekten und Strings.
		\end{itemize}
	\item[assertSame(Object expected, Object actual)] \hfill \\
		Vergleicht Referenzen mittels == Operator
	\item[assertNull(Object x), assertTrue(boolean b)] \hfill \\
	\item[fail()] \hfill \\
		Lässt den Test manuell fehlschlagen
\end{description}

\subsubsection{Exception}
Exceptions können getestet werden. Falls nur eine Exception erwartet wird:
\begin{itemize}
	\item Schreibe die Exception zu einem expected Argument in der @Test Notation.
	\item @Test(expected=IllegalArgumentException.class)
\end{itemize}

\subsection{Beispiele}
\lstinputlisting[language=Java,caption=Unit-Test Beispiel,style=MyJavaStyle]{unit-test.java}

\pagebreak
\section{Isolated Testing}

\subsection{Test doubles in Unit Testing}
\includegraphics[scale=0.8]{test_doubles.png}
\begin{itemize}
	\item[\Bold {Dummy}] Meist nur benutzt um Parameter-Listen zu füllen 
	\item[\Bold {Stubs}] Minimale Implementation von Schnittstellen oder Basisklassen, void hat normalerweise kein Code und die anderen Methoden fest kodierte Werte
	\item[\Bold {Spys}]	 	Ähnlich wie Stubs, aber zeichnen verwendete Mitglieder von Klasse auf
	\item[\Bold {Fakes}]	Haben bereits oft komplexe Implementierung, verwalten Interaktion zwischen den verschiedenen Mitgliedern von denen Sie erben
	\item[\Bold {Mocks}] 	Vorprogrammierte Objekte mit fest kodierten Erwartungen
\end{itemize}
\begin{lstlisting}[language=Java,caption=Beispiel von Stub, style=MyJavaStyle]
class EmailStub {
    void sentMail (String mailText) {
    ;
    }
}
\end{lstlisting}
Parameterübergabe funktioniert, jedoch wird keine Funktion ausgeführt, da nur void.

\subsection{Mock Testing}
Mock-Objekte simulieren Teile des Verhaltens von Domain-Objekten. Klassen können in Isolation, durch die Simulation von ihren Mitarbeitern, mit Mock-Objekten getestet werden. Nimmt Klassen aus einer natürlichen Umgebung und stellt sie in eine gut definierte Testumgebung.

\subsubsection{Einsatzbereich von Mock-Objekten}
\begin{itemize}
	\item Verhalten von realem Objekt ist nicht-deterministisch
	\item Reales Objekt schwierig aufzusetzen (z.B. komplette Server-Umgebung)
	\item Reales Objekt ist langsam
	\item Reales Objekt verfügt über GUI
	\item Der Test hängt von vorhergehenden Zuständen ab
	\item Reales Objekt existiert noch nicht
\end{itemize}
\begin{description}
	\item[Pros] \hfill
		\begin{itemize}
			\item Test völlig isoliert
			\item Vereinfacht Schnittstelle zu vielen Methoden
			\item Nahezu alles kann getestet werden wie z.B. JDBC
		\end{itemize}
	\item[Cons] \hfill
		\begin{itemize}
			\item Kann Implementierung zu ähnlich sein, könnte den Test unbrauchbar machen
			\item Kann komplex werden bei z.B. JDBC
		\end{itemize}
\end{description}

\subsection{EasyMock}

Generiert Mock Objekte dynamisch, es ist nicht nötig, sie selbst zu schreiben und Code zu generieren.
\begin{itemize}
\item Kreieren
\item Aufzeichnen
\item Replay
\item Normales Testing
\item Verify
\end{itemize}

\subsubsection{Spezielle Vorteile von EasyMock}
\begin{itemize}
\item Selber-Programmiern von Mock Objekten fällt weg
\item Sind Refactoring-Safe, wird also eine Methode umbenannt ist das kein Problem
\item Return Werte \& Exceptions sind unterstützt
\item Erlaubt Überprüfung der Reihenfolge in welcher Methoden vom Mock Objekt aufgerufen werden 
\item Anzahl der Aufrufe einer Mock-Objekts können überwacht werden
\end{itemize}

\subsubsection{Ablauf}
\includegraphics[scale=0.6]{easymock.png} \\

\subsubsection{Befehle}
\begin{description}
	\item[createMock(Class$<T>$ toMock)] \hfill \\
		Creates a mock object that implements the given interface, order checking is disabled by default.
	\item[createStrictMock(Class$<T>$ toMock)] \hfill \\
		Creates a mock object that implements the given interface, order checking is enabled by default.
	\item[createNiceMock(Class$<T>$ toMock)] \hfill \\
		Creates a mock object that implements the given interface, order checking is disabled by default, and the mock object will return 0, null or false for unexpected invocations.
	\item[expect$<T>$(T value)] \hfill \\
		Returns the expectation setter for the last expected invocation in the current thread.
	\item[expectLastCall()] \hfill \\
		Returns the expectation setter for the last expected invocation in the current thread. This method is used for expected invocations on void methods. 
	\item[reset()] \hfill \\
		Resets the given mock objects (more exactly: the controls of the mock objects).
	\item[replay()] \hfill \\
		 Switches the given mock objects (more exactly: the controls of the mock objects) to replay mode.
	\item[verify()] \hfill \\
		Verifies the given mock objects (more exactly: the controls of the mock objects).	 
	\item[andThrow(jThrowable)] \hfill \\
		Sets a throwable that will be thrown for the expected invocation.
	\item[times(count), times(min, max), once(), atLeastOnce() \& anyTimes()] \hfill \\
		Those defines number of expected calls.
\end{description}
\subsubsection{Beispiel}
\lstinputlisting[label=Mock-Test,caption=Beispiel Mock-Test1, style=MyJavaStyle]{mock-test.java}


\includegraphics[scale=0.8]{EasyMockStuff.png}

\pagebreak
\section{Software Quality Metrics}
\subsection{Was ist Software Qualität?}
\includegraphics[scale=1]{Metrics.png}
\subsection{Metric (Def)}
\begin{description}
	\item[Size Metrics] \hfill 
		\begin{itemize}
			\item Lines of Code(LoC)
			\item Number of Statements
			\item Fields, Methods
			\item Packages
		\end{itemize}
	\item[Dataflow Metrics] \hfill
		\begin{itemize}
			\item Cyclomatic Complexity (McCabe Complexity)
			\item Dead Code detection
			\item Initialization before use
		\end{itemize}
	\item[Style Metrics] \hfill 
		\begin{itemize}
			\item Number of Levels (nesting depth)
			\item Naming conventions, formatting conventions
		\end{itemize}
	\item[OO Metrics] \hfill
		\begin{itemize}
			\item No. of classes, packages, methods
			\item Inheritance depth / width
		\end{itemize}
	\item[Coupling Metrics] \hfill
		\begin{itemize}
			\item LCOM: lack of cohesion metrics
			\item No. of calling classes / no. of called classes
			\item Efferent / Afferent couplings
		\end{itemize}
	\item[Statistic Metrics] \hfill
		\begin{itemize}
			\item Instability
			\item Abstractness
		\end{itemize}
	\item[Performance Metrics (dynamic)] \hfill 
		\begin{itemize}
			\item Time spent
			\item Memory consumption (also memory leaks)
			\item Network traffic
			\item Bandwidth needed
			\item No. of clicks to perform a task
		\end{itemize}
	\item[Other dynamic metrics] \hfill 
		\begin{itemize}
			\item No. of tests executed
			\item No. of failed tests
			\item Code coverage
		\end{itemize}
\end{description}

\subsection{Cyclomatic Complexity}
Anzahl von möglichen verschiedenen Pfaden durch den Code. So wird gerechnet:
Cyc. Complex. $= b + 1$, wobei $b =$ binäre Entscheidungen wie \Bold {if, while, for, case,} ...\\
$N < 10 \Ra $ code ist gut lesbar\\
Kritik: Switch-Statements sind gut lesbar aber treiben die Cyclomatic Complexity nach oben

\subsection{Cohesion and Coupling Metrics}
\begin{description}
	\item[Cohesion] \hfill \\
		Misst, wie nahe sich die Klassen sind
	\item[Coupling / Dependency] \hfill \\
		Misst den Grad, wie stark eine Klasse von anderen abhängig ist
	\item Tiefes Coupling geht oft einher mit hoher Cohesion
	\item Metrics: LCOM (Lack of Cohesion in Method)
\end{description}

\subsubsection{LCOM}
$LCOM^{HS} = \frac{m-avg(r(f))}{m}$
\begin{description}
	\item[Where] \hfill
		\begin{itemize}
			\item m is the number of methods of a class
			\item r(f) is the number of methods that access a field f
			\item Average r(f) over all fields.
		\end{itemize}
	\item[Examples] \hfill
		\begin{itemize}
			\item Each method accesses only one field \\
				$LCOM^{HS}$ = (almost) 1 low cohesion \\
				$\ra$ i.e. getters/setters are bad
			\item Each method reads all fields \\
				$LCOM^{HS}$ = 0 high cohesion
		\end{itemize}
\end{description}

\subsubsection{Emma Features (Java-Code-Coverage Instrument)}
\begin{itemize}
\item Byte Code und Offline and on-the-fly
\item Überprüft Klassen, Methoden, Linien und Standardblöcke
\item Erstellt Reports in TXT, HTML, XML
\item Statistik möglich zu einzelnen Methoden, Klassen und Packages sowie für alle Klassen gemeinsam
\item Ausführbar via ANT, CMD, Eclipse Plugin
\end{itemize}

\subsubsection{Warum Metrics verwenden?}
\begin{itemize}
\item Wichtiges Tool für Qualitätsmessung
\item 'You can't manage what you can't control, and you can't control what you don't measure'
\item Jedoch nicht übertreiben mit Messen, ein sinnvolles Mass soll gefunden werden
\end{itemize}


\pagebreak
\section{Refactoring}
\begin{itemize}
	\item Refactoring verbessert das Design Ihres Systems
	\item Refactoring macht Ihre Software einfacher zu verstehen
	\item Refactoring hilft Ihnen, Fehler zu finden
\end{itemize}
\Bold {Versuche nicht, Features hinzuzufügen, wenn man den  Refactoring-Hut trägt.} \\ \\
\includegraphics[scale=0.4]{refactoring_workflow.png}

\subsection{Problems}
\begin{itemize}
	\item Zu weit getrieben, kann Refactoring zu einer unaufhörliche Bastelei mit dem Code führen, damit er perfekt wird.
	\item Bei Datenbanken kann Refactoring schwierig werden.
	\item Refactoring veröffentlichter Schnittstellen kann Probleme für die Entwickler bedeuten, die diese Schnittstellen benützen
\end{itemize}

\subsection{Code Smells}
\begin{description}
	\item[Too Much Code Smells] \hfill
		\begin{itemize}
			\item Doppelter Code
			\item Lange Methoden
			\item Grosse Klassen
			\item Lange Parameter Listen
			\item Feature Envy
			\item Switch Statements
			\item Parallele Vererbungshierarchie
		\end{itemize}
	\item[Not Enough Code Smells] \hfill 
		\begin{itemize}
			\item Leere Catch clause
		\end{itemize}
	\item[Code Change Smells] \hfill
		\begin{itemize}
			\item Divergent Change
			\item Shotgun Surgery	
		\end{itemize}
	\item[Comment Smells] \hfill 
		\begin{itemize}
			\item Muss kommentiert werden
			\item Zu viel Kommentar
		\end{itemize}
\end{description}

\subsection{How To}
\subsubsection{Extract Method}
Code-Fragmente in eigene Methoden fassen. Grosse Methoden in Kleine aufteilen.\\
\includegraphics[scale=.6]{refactoring_1.png}
\subsubsection{Self Encapsulate Field}
Getter- und Setter-Methoden einsetzen. Damit ist ein einheitlicher Zugriff von Aussen sichergestellt, unabhängig ob das Resultat aus einer Variable oder Berechnung stammt.\\
\includegraphics[scale=.6]{refactoring_2.png}
\subsubsection{Move Method}
Wenn eine Methode mehr auf Daten einer fremden Klasse als auf die der eigenen Klasse zugreift, ist sie ein guter Kandidat um in die andere Klasse verschoben zu werden.\\
\includegraphics[scale=.6]{refactoring_3.png}
\subsubsection{Replace Temp with Query}
Komplizierte Berechnungen in eigene Methoden verschieben, anstatt deren Resultat in Variablen zu speichern.\\
\includegraphics[scale=.6]{refactoring_4.png}
\subsubsection{Replace Type Code with State/Strategy}
Eine Klasse hat verschiedene Verhaltensweisen abhängig von einer Typ- oder Statusvariable. Verwendung des Strategy- oder State-Patterns (Aggregation einer abstrakten Klasse mit entsprechenden Unterklassen) um verschiedene Fälle mit Polymorphie abzufangen.\\
\includegraphics[scale=.6]{refactoring_5.png}
\subsubsection{Replace Conditional with Polymorphism}
Ebenfalls Verwendung von Polymorphie. Jeder Fall eines Case-Statements wird in eine eigene Unterklasse verschoben.\\
\includegraphics[scale=.6]{refactoring_6.png}

\pagebreak
\section{Coding Style \& Clean Code}
Sauberer Code ist einfach und direkt. Sauberer Code liest sich wie gut geschriebene Prosa. Sauberer Code niemals verdeckt die Absicht des Konstrukteurs, sondern ist voll von frischen Abstraktionen und einfache Linien der Kontrolle. \\
\subsection{Warum soll man Code Conventions befolgen?}
\begin{itemize}
\item 80\% der Lebensdauer einer Software besteht aus Wartung
\item Kaum eine Software wird nur vom Autor gewartet
\item Verbessern Lesbarkeit, so dass neuer Code schneller und besser zu verstehen ist
\item Macht Code einfacher zu verbessern und Bugs zu entdecken
\end{itemize}
Code conventions denkt die folgenden Themen ab: 
\begin{description}
	\item[Dateinamen und -organisation] \hfill 
		\begin{itemize}
			\item Dateinamen, Ordner
			\item Ordnerstruktur eines Projekts
			\item Struktur der Codedateien
		\end{itemize}
	\item[Einrückung] \hfill
		\begin{itemize}
			\item Tabs vs. Leerschläge
			\item Linienlänge
			\item Linienumbruch, Zeilenumbruch Regeln
		\end{itemize}
	\item[Namenskonventionen] \hfill
		\begin{itemize}
			\item Namenskonventionen machen Programme verständlicher, so dass sie leichter zu lesen, zu verbessern und um Fehler zu erkennen
		\end{itemize}
	\item[Erklärungen, Äusserungen und White Spaces] \hfill 
		\begin{itemize}
			\item Wie viele Variablendeklarationen pro Linie?
			\item Wo sollen Variablen deklariert werden?
			\item Wo sollen die \{\} Klammern sein?
			\item Wo sollen leere Linien sein?
		\end{itemize}
\end{description}

\subsection{API Documentation}
API-Dokumentation ist ein Vertrag zwischen Ihnen und den Kunden von Ihrem Code. Es gibt den Zweck der Klasse / Interface und die Funktionalität der Methoden. Biete was wirklich gebraucht wird.

\subsection{Klassen/Interface Dokumentation}
\begin{itemize}
	\item Spezifiziert Sinn und Zuständigkeit von Klasse, wenn möglich in 1 Satz
	\item Spezifiziert wichtige Eigenschaften, die nicht durch Code ausgedrückt sind
	\item Klasse: Erklärt Eigenschaft verwendeter Algorithmen (Performance, Speicher, ...)
	\item Interface: Erklärt, was gemacht wurde und nicht wie es gemacht werden soll
\end{itemize}

\subsection{Methoden Dokumentation}
\begin{itemize}
	\item Spezifiziert was man vom Aufrufer erwartet (Percond., Parameter)
	\item Spezifiziert was man dem Aufrufer zurückgibt (Postcond., Invariante., Return-Wert)
\end{itemize}

\subsection{Wichtig zu beachten}
\begin{itemize}
\item Selbstsprechende Namen sind sehr wichtig und sollen gebraucht werden
\item Mittels TODO, FIXME (Bug) und XXX (Nochmals überdenken) können Marker gesetzt werden, Eclipse unterstützt dies und zeigt diese im UI an
\end{itemize}

\subsection{Javadoc}
Javadoc ist ein separates Programm, das mit dem JDK mitgeliefert wird. Es liest das Programm, macht Listen aller Klassen, Interfaces, Methoden und Variablen, und erzeugt HTML-Seiten auf der die Ergebnisse angezeigt werden. \\
Schreibe Kommentare für den Programmierer der die Klasse benützt: 
\begin{itemize}
	\item Alles, was man ausserhalb der Klasse zur Verfügung stellen will, sollte dokumentiert werden
	\item Es ist eine gute Idee, private Elemente, auch für den eigenen Gebrauch, zu beschreiben
\end{itemize}
Javadoc kann Dokumentation erzeugen für:
\begin{itemize}
	\item nur public Elemente
	\item public und protected Elemente
	\item public, protected, und package Elemente
	\item public, protected, package, und private Elemente
\end{itemize}
Javadoc ist möglich bei:
\begin{itemize}
	\item Package
	\item Klasse
	\item Interface
	\item Konstruktor
	\item Methode	
	\item Feld
\end{itemize}

\subsubsection{Tags in Javadoc Comments}
\begin{description}
	\item[@param p]			Beschreibung des Parameters p.
	\item[@return] 			Beschreibung des return-Werts (es sei denn, die Metohde gibt void zurück).
	\item[@exception e] Exceptions welche von der Methode geworfen werden.
	\item[@see] 				Fügt ein 'See Also' hinzu mit einem Link oder text das auf eine Referenz zeigt
	\item[@author]			Dein Name
	\item[@version] 		Eine Versionsnummer oder -datum
\end{description}

\subsection{Programming Practices}
\begin{itemize}
\item Keine 'magischen Zahlen' wie 4.352, viel besser Konstanten verwenden, d.h. Werte nicht mitten im Code erstellen, sondern gesammelt an einem Ort
\item Run-Time Performance verbessern sollte man dem Compiler überlassen
\item Kein if (value == true) { return true; } else { return false; } $\to$ return value;
\item In einer Methode nur Etwas machen und nicht mehrere Sachen
\item If (!value) ist nicht so gut lesbar wie if (value)
\end{itemize}

\subsection{Checkstyle}
\begin{itemize}
\item Überprüft Code nach vorgegebenen Regeln
\item Eigene Tests können geschrieben werden
\item XML-Konfigurationsdatei wird verwendet
\end{itemize}

\begin{lstlisting}[language=Java,caption=JavaDoc Beispiel 1, style=MyJavaStyle]
/**
 * Manages the stock of videos of the rental shop.
 * @author Christoph Denzler
 *
 */
public class Stock {
  
  /** The stock of videos. */
  private HashMap<String, Integer> stock = new HashMap<String, Integer>();
  
  /** low stock listeners. */
  private List<LowStockListener> listeners = new LinkedList<LowStockListener>();
  
  /**
   * add a movie to the stock.
   * @param movie the movie to add to the stock.
   * @return the number of items of this movie in stock after this operation.
   */
  public int addToStock(IMovie movie) {
\end{lstlisting}

\begin{lstlisting}[language=Java,caption=JavaDoc Beispiel 2, style=MyJavaStyle]
    /**
     * Create a new user with the given name information.
     * 
     * @param aName the user's family name.
     * @param aFirstName the user's first name.
     * @param aBirthdate the user's birth date.
     * @throws NullPointerException The name must neither be <code>null</code>.
     * @throws MovieRentalException If the name is empty ("") or longer than 40 characters.
     */
\end{lstlisting}

\begin{lstlisting}[language=Java,caption=JavaDoc Beispiel 3, style=MyJavaStyle]
    /**
     * The first three days cost only 1.5, then each days costs an extra 1.5.
     * 
     * @see ch.fhnw.edu.rental.model.PriceCategory#getCharge(int)
     * @param daysRented no of days that a movie is rented.
     * @return rental price for movie.
     */
    @Override
    public double getCharge(int daysRented) {
\end{lstlisting}

\pagebreak
\section{Logging}
\begin{itemize}
	\item Wichtig für Monitoring und Debugging Applikationen
\item Debugging: Betrifft den Status des Programmes im Zeitpunkt des Ausführens
\item Logging: Stellt Logging-Daten über ein Programm über eine Zeitspanne bereit
\item Wichtig bei Echtzeit-Systemen, verteilten Systemen und gleichzeitigen Systemen
\end{itemize}

\subsection{Vorteile}
\begin{itemize}
	\item Die Konfiguration der Logging-Funktionen wird ausgelagert
	\item Lognachrichten können priorisiert werden
	\item Logging unterstützt verschiedene Nachrichtenformatierungen
	\item An- und Abschalten während das Programm läuft
	\item Unterstützt verschiedene Ausgabeziele
	\item Verschiedene Ausgabestufen
	\item Unterstützt Nachrichten abzufangen um Performanz hoch zu halten
\end{itemize}

\subsection{Log4j}
\begin{itemize}
\item Soll verwendet werden anstelle von System.out.println
\item Output kann extern ausgegeben werden, Priorisierung, versch. Ausgabeformate, zur Laufzeit aktiviert bzw. deaktiviert werden, verschiedene Logstufen, Message-Caching wird unterstützt, um Performance-Einbusse zu verhindern
\end{itemize}

\subsection{Konzept}
\begin{itemize}
	\item[\Bold {Priority}] Bestimmt, was geloggt wird.
	\item[\Bold {Level}] Bestimmt, ob etwas geloggt wird.
	\item[\Bold {Appender}] Bestimmt, wo etwas geloggt wird.
	\item[\Bold {Layout}] Bestimmt, wie das Layout aussieht.
	\item[\Bold {Logger}] Schreibt einen Log-Eintrag zu einem Appender in einem bestimmten Layout falls das Logging-Level angemessen ist.
\end{itemize}

\subsection{Logging Levels}
\begin{itemize}
	\item[\Bold {FATAL}] Fehler, bei dem die Applikation sich nicht mehr erholen kann
	\item[\Bold {ERROR}] Fehler, die Applikation ist jedoch nicht lauffähig
	\item[\Bold {WARN}] Informiert über 'schlimmes' Ereignis
	\item[\Bold {INFO}] Informiert z.B. über Fortschritt der Applikation
	\item[\Bold {DEBUG}] Stellt Informationen für Debug bereit 
	\item[\Bold {TRACE}] Sehr detaillierte Informationen um Informationsfluss zu verfolgen
Werden direkt auch so aufgerufen $\to$ info(Object message [, Throwable throwable] ); oder log(Priority level, Object message,Throwable throwable);
\end{itemize}

\subsection{Aufbau des Loggers}
\includegraphics[scale=1]{log4j.png}

\subsection{Verschiedene Appender}
\begin{itemize}
\item ConsoleAppender - Write log to System.out or System.err
\item FileAppender - Write to a log file
\item SocketAppender - Dumps log output to a socket
\item SyslogAppender - Write to the syslog.
\item NTEventLogAppender - Write the logs to the NT Event Log system.
\item RollingFileAppender - After a certain size is reached it will rename the old file and start with a new one.
\item SocketAppender - Dumps log output to a socket
\item SMTPAppender - Send Messages to email
\item JMSAppender - Sends messages using Java Messaging Service
\end{itemize}

\subsection{PatternLayout Platzhalter}
\begin{itemize}
\item[\Bold{\%C:}] For example, for the class name org.apache.xyz.SomeClass, the pattern \%C{1} will output SomeClass
\item[\Bold{\%d}]: For example, \%d\{HH:mm:ss,SSS\} or \%d\{dd MMM yyyy HH:mm:ss,SSS\}
\item[\Bold{\%F:}] Datei, die das Logging veranlasst hat
\item[\Bold{\%L:}] Code-Linie vom Logevent
\item[\Bold{\%m:}] Message
\item[\Bold{\%M:}] Methode
\item[\Bold{\%n:}] Neue Linie wie '$\backslash$n'
\item[\Bold{\%p:}] Priorität
\item[\Bold{\%r:}] Zeitmessung Logevent
\item[\Bold{\%t:}] Thread
\end{itemize}

\subsection{Best Practices} 
\begin{itemize}
\item e.printStackTrace() nicht verwenden sondern log.error("Exception message", e)
\item Keine Exception loggen und sie dann trotzdem werfen
\item Wenn möglich immer Stack Trace anhängen mit \} catch(SQLException e)\{ 
throw new RuntimeException("DB exception", e); \}
\end{itemize}

\lstinputlisting[language=Octave,caption=Log4j XML Teil,style=MyAntStyle]{log4j.xml}
\lstinputlisting[language=java,caption=Log4j Java Teil,style=MyJavaStyle]{log4j.java}


\pagebreak
\section{GUI- Testing}
\subsection{Zweck von GUI Tests test?}
\begin{itemize}
\item Werden richtige Funktionen ausgeführt?
\item Wird die Funktion korrekt ausgeführt?
\item Ist der Navigationsfluss korrekt?
\item Stellt das GUI die Daten korrekt dar?
\item Zeigt das GUI die richtigen Daten?
\item Sind die Steuerungen im richtigen Zustand?
\end{itemize}

\subsection{How to GUI-Testing}
\subsubsection{Manual}
\begin{itemize}
\item Jeder Schritt wird von Hand ausgeführt.
\item Sehr arbeitsintensiv, sehr fehleranfällig.
\item Muss jedes Mal erneuert werden, falls ein Regressionstest erforderlich ist.
\item Sehr teuer
\end{itemize}
Es ist schwierig einen manuellen Test systematisch zu handhaben.

\subsubsection{Capture / Replay}
\begin{itemize}
\item Meist mehrere Prorgamme, die Benutzereingaben aufzeichnen
\item Umfasst meistens Scripting
\item Grosser Nachteil: ändert das GUI muss auch der Test neu gemacht werden
\end{itemize}


\subsubsection{Scripting - In a seperate scripting language}
\textbf{\Bold Workflow:} $Writing Script \Longrightarrow SCRIPT \Longrightarrow REPLAY TOOL \Longrightarrow Execute Tests Automatically$

\begin{itemize}
\item Weitere Programmiersprache
\item Muss an irgendeiner Form der formalen Verifikation unterzogen werden.
\item Eliminiert menschliche Fehler während der Ausführung des Tests.
\item Kann für Regressionstests benutzt werden (manchmal auch mit Modifikationen).
\item Verschiedene Ansätze zum Testen.
\item Spion GUI Steuerung.
\item Bildverarbeitung
\end{itemize}

\subsubsection{Integrated Test Framework (Unit Test Programming Style)}
\begin{itemize}
\item Scripting braucht selbe Programmiersprache wie prod. Code
\item Scripts einfach/schnell anpassbar und vollständig in IDE integriert
\item Wird meistens gleichzeitig wie Unit-Tests ausgeführt
\item Wichtige Aspekte für Test-Driven Development
\begin{itemize}
\item Model von der View trennen (siehe MVC-Modell)
\item Eindeutige Namen für jedes GUI-Element
\item Nicht zu 'tief' testen, wie z.B. Verhalten von Standardkomponenten
\item Fokus auf Prüfung des Verhaltens/Zustandes des GUIs
\end{itemize}
\end{itemize}

\subsection{FEST (GUI-Testing Tool)}
\begin{itemize}
\item A Collection of API's for functional Swing GUI testing
\item Simulation of user-generated events and reliable GUI component lookup
\item Easy-to-use and powerful API that simplifies creation and maintenance of Swing GUI functional tests
\item Runs JUnit or TestNG test
\end{itemize}

\subsubsection{Workflow}
\begin{enumerate}
\item Create a setup method to create your own GUI instance (either frame or dialog)\\
\includegraphics[scale=0.6]{FEST_Setup.png}

\item Close window and release resources\\
\includegraphics[scale=0.6]{FEST_CleanUP.png}
\pagebreak
\item Execute the actions on the controls
\item Verify expected behavior.\\
\includegraphics[scale=0.6]{FEST_Test.png}
\end{enumerate}
\begin{lstlisting}[language=Java,caption=FEST Beispiel 1.a, style=MyJavaStyle]
public class Hello extends JFrame {

    JLabel nameLabel = new JLabel("Please enter your name: ");
    JTextField nameTextField = new JTextField();
    JButton button = new JButton("Say Hello");
    JLabel welcomeLabel = new JLabel();

    public static void main(String[] args) {
        Hello hello = new Hello();
        hello.setVisible(true);
    }

    public Hello() {
        setLayout(new BorderLayout());
        JPanel namePanel = new JPanel();
        namePanel.setLayout(new FlowLayout());
        nameLabel.setAlignmentY(1.0f);
        nameTextField.setPreferredSize(new Dimension(300, 24));
        button.setPreferredSize(new Dimension(100, 40));
        welcomeLabel.setPreferredSize(new Dimension(350, 30));      
        welcomeLabel.setName("welcomeLabel");
        button.setName("helloButton");
        nameTextField.setName("nameTextField");

        button.addActionListener(new ActionListener() {

            @Override
            public void actionPerformed(ActionEvent arg0) {
                String name = nameTextField.getText();
                if (name == null || name.trim().isEmpty()) {
                    JOptionPane.showInternalMessageDialog(nameTextField,
                            "Please enter a name!");
                } else {
                    welcomeLabel.setText("Welcome " + nameTextField.getText());
                }}});
        namePanel.add(nameLabel);
        namePanel.add(nameTextField);
        add(BorderLayout.NORTH, namePanel);
        add(BorderLayout.WEST, button);
        add(BorderLayout.SOUTH, welcomeLabel);
        pack();
    }
}
\end{lstlisting}

\begin{lstlisting}[language=Java,caption=FEST Beispiel 1.b, style=MyJavaStyle]
package gui;

import org.fest.swing.*
import org.junit.*;

public class HelloTest {

    private FrameFixture window;

    @Before
    public void setUp() throws Exception {
        Hello frame = GuiActionRunner.execute(new GuiQuery<Hello>() {
            protected Hello executeInEDT() {
                return new Hello();
            }
        });
        window = new FrameFixture(frame);
        window.show();
    }

    @After
    public void tearDown() throws Exception {
        if (window != null) {
            window.cleanUp();
        }
    }

    @Test
    public void shouldCopyTxtInLabelWhenClickingButton() {
        window.textBox("nameTextField").enterText("Hans");
        window.button("helloButton").click();
        window.label("welcomeLabel").requireText("Welcome Hans");
    }
    
    @Test
    public void shouldGiveErrorWhenClickingButtonNoName() {
        window.textBox("nameTextField").enterText("");
        window.button("helloButton").click();
        window.optionPane().requireMessage("Please enter a name!");
    }
}
\end{lstlisting}
\pagebreak
\section{Web und Akzeptanztests}
\textbf{\Bold Anforderungen sind das Problem Nummer 1 beim Web und Akzeptanztesting}\\
\subsection{Herausforderungen bei Webtests}
\begin{itemize}
\item Teile der Applikation laufen im Browser ab
\item Wenig(er) Kontrolle über die Laufzeitumgebung
\item Browser-Inkompatibilitäten (IE vs. Firefox vs. Chrome vs. Opera vs. Safari)
\item Tools müssen auf verschiedene Browser zugreifen können
\item Eigentlich wird ein verteiltes System getestet, da vom Browser immer auch http(s)-Requests auf den Server stattfinden.
\end{itemize}

\subsection{Selenium Testing System}
\subsubsection{Wie ist Selenium aufgebaut?}
Selenium besteht aus mehreren Teilen, nicht jedes Testprojekt benötigt alle Teile:
\begin{itemize}
\item \textbf{\Bold Selenium IDE:} ein Capture/Replay-Plugin für Firefox erlaubt auch das Editieren der aufgenommenen Skripts
\item \textbf{\Bold Selenium WebDriver:} API um Browser programmatisch anzusteuern (z.B. aus Java, C-Sharp, PHP, Ruby). Kann auch aufgenommene Skripts gegen andere Browser (Firefox) ausführen
\item \textbf{\Bold Selenium Server:} Koordiniert mehrere WebDriver um echte Lastszenarien zu simulieren.

\end{itemize}

\subsubsection{Was bietet Selenium?}
\begin{itemize}
\item Selenium bietet Capture/Replay Funktionalität
\item Generiert Skript, das editierbar ist
\item Da HTML verwendet wird, können Events einzelnen Elementen zugeordnet werden
\item Keine Aufzeichnung von GUI-Koordinaten nötig\\
(ABER: Jedes Element muss eindeutige ID haben!)
\end{itemize}

\subsection{Die Kundensicht}
Für den Kunden stehen die Geschäftsprozesse immer im Vordergrund.\\\\
\textbf{\Bold Definition:} Ein Geschäftsprozess ist eine Folge von koordinierten Aufgaben und Aktivitäten, die das Ziel haben ein Geschäftsresultat zu realisieren.

\subsubsection{Eigenschaften eines Geschäftsprozesses}
\begin{itemize}
\item Nach Aussen gerichtet (beschreibt beobachtbares Verhalten)
\item Benutzeranforderung
\item Wiederholte Durchführung
\item Unabhängig von GUI
\end{itemize}

\subsubsection{Feedback}
Ein frühes Feedback gegenüber dem Kunden, hilft eine Software korrekt und wunschgemäass zu entwickeln.\\\\
\textbf{\Bold Problem:} Unittests sind nicht wirklich aussagekräftig und GUI-Test werden erst spät im Projekt gemacht. Daher sollten früh im Projekt mit dem Kunden zusammen Akzeptanztest erstellt und definiert werden.

\subsubsection{Herausforderung beim Erstellen von Akzeptanztests}
\begin{description}
\item[\Bold {Prozesse}] \hfill \\ 
	Wie können Prozesse als Test beschrieben werden?
\item[\Bold {Die Sprache}] \hfill \\
	Entwicklersprache vs. Benutzersprache
\item[\Bold{Komplexität}] \hfill \\
	Formalisierung der Anforderungen
\item[\Bold{Abhängigkeiten}] \hfill \\
	Prozessintern\\
	$\rightarrow$ Teilaktivitäten hängen von einander ab\\
	Prozessextern\\
	$\rightarrow$ High-Level Prozesse bauen auf Low-Level Komponenten und externen Systemen auf
\item \Bold {Infrastruktur ist nicht verfügbar}
\item[\Bold {Automatisierung}] \hfill \\ 
	Essentiell für Regressionstests
\end{description}

\subsection{FIT - Framework for Integrated Testing}
\subsubsection{Einleitung}
\Bold {Ziel:}
\begin{itemize}
\item Vermeidung von Anforderungsfehlern durch Einrichtung einer frühen Feedback-Loop zwischen Entwicklern und Benutzern auf Testbasis
\end{itemize}
\Bold {Konzepte:}
\begin{itemize}
\item Ausführbare Use Cases und Workflows
\item Für Kunden/Benutzer verständlich und durch diesen erstellbar
\item Konkrete Beispiele (Testing by Example)
\end{itemize}

\subsubsection{Architekturkonzept}
\includegraphics[scale=0.5]{FIT_Architekturkonzept.png}

\subsubsection{Vorgehenskonzept}
\includegraphics[scale=0.5]{FIT_Vorgehenskonzept.png}

\subsubsection{Hinweise zur Testspezifikation}
\begin{itemize}
\item Auswahl der richtigen Tabellen-Typen
\item Sprache des Benutzers wählen
\item Lesbare Testnamen\\
Statt Fixtures.TestSearchSubmit$ \rightarrow$ Test Search Submit
Fit generiert den Klassennamen (CamelCase, Graceful Names)
\item Initialisierung/Setup und Aufräumen der Testumgebung/TearDown wird unterstüzt.
\item Kunde und Entwickler erarbeiten Tests gemeinsam
\end{itemize}

\subsubsection{FIT Fixtures}
Die Testfälle werden bei Fit in HTML-Tabellen definiert. Die Anbindung an das zu testende Programm erfolgt über Java-Klassen, die "Fixtures" genannt werden, und die bestimmte Fit-Fixture-Klassen erweitern.\\
Es gibt die drei Basis-Fixtures ColumnFixture, RowFixture und ActionFixture. Wenn auf Zusatzbibliotheken (z.B. FitLibrary) zurückgegriffen wird, stehen zusätzlich noch viele weitere Fixtures zur Verfügung (z.B. DoFixture).\\
Die folgende Tabelle beschreibt die drei Basis-Fixture-Typen:\\
\includegraphics[scale=0.55]{FIT_Fixtures.png}

\subsubsection{Testimplementierung}
Von den Tabellen zu der Implementierung:\\
\includegraphics[scale=0.6]{FIT_TestImplementierung.png}

\subsubsection{Hinweise zur Testimplementation}
\begin{itemize}
\item Auch Testcode muss gewartet werden
\item Prozesskontext definieren
	\begin{itemize}
		\item Datenübergabe über statics 
	\end{itemize}
\item Fit Fixtures für domänenspezifische Bedürfnisse verfügbar (z.B. Web, DB)
\item Falls notwendig erweiterbar
	\begin{itemize}
		\item Neue Befehle durch Ableitung von ActionFixture
		\item Eigene Fixture-Klassen
	\end{itemize}
\item Auf Trennung zwischen Businesslogik und Testcode achten
	\begin{itemize}
		\item Fit-Tests in separatem Test-Verzeichnis
	\end{itemize}
\end{itemize}

\newpage
\section{Zusätzlicher Sourcecode}
\begin{lstlisting}[language=Java,caption=JUnit-Test mit Javadoc, style=MyJavaStyle]
  /**
   * Test method for {@link ch.fhnw.edu.rental.model.Movie#Movie(java.lang.String, 
   * ch.fhnw.edu.rental.model.PriceCategory)}.
   * @throws InterruptedException must not be thrown
   */
  @Test
  public void testMovieStringPriceCategory() throws InterruptedException {
    // get time before object creation
    Date before = new Date(Calendar.getInstance().getTimeInMillis());
    // spend some time to be able to detect differences in timestamps
    Thread.sleep(10);

    // now allocate new instance
    Movie m = new Movie("A", RegularPriceCategory.getInstance(), 18);
    // get time after object creation
    Thread.sleep(10);
    Date after = new Date(Calendar.getInstance().getTimeInMillis());
    
    assertNotNull(m);
    assertEquals("A", m.getTitle());
    assertEquals(RegularPriceCategory.class, m.getPriceCategory().getClass());
    Date releaseDate = m.getReleaseDate();
    assertNotNull(releaseDate);
    assertTrue(before.before(releaseDate));
    assertTrue("Expected release date to be earlier.", after.after(releaseDate));
    assertFalse(m.isRented());
    assertEquals(18, m.getAgeRating());
  }
\end{lstlisting}
\begin{lstlisting}[language=Java,caption=Junit-Test mit Mock-Testing, style=MyJavaStyle]
    @Test
    public void testRemoveLowStockListener() {
        expect(m.getTitle()).andStubReturn("Tarzan");
        expect(l.getThreshold()).andReturn(2).once();
        l.stockLow(m, 2);
        
        replay(m);
        replay(l);
        
        st.addLowStockListener(l);
        
        st.addToStock(m);
        st.addToStock(m);
        st.addToStock(m);
        st.removeFromStock(m);
        
        st.removeLowStockListener(l);
        st.addToStock(m);
        st.removeFromStock(m);
        
        verify(l);
        verify(m);
    }
\end{lstlisting}

\begin{lstlisting}[language=Java,caption=Junit-Test mit korrekter Verwendung von fail(), style=MyJavaStyle]
    @Test
    public void testExceptionRental() throws InterruptedException {
        Rental r = null;
        try {
            r = new Rental(null, m1, 1);
            fail();
        } catch (NullPointerException e) {
            assertEquals(NULLMESSAGE, e.getMessage());
        }
\end{lstlisting}

\begin{lstlisting}[language=Java,caption=Methode mit JavaDoc, style=MyJavaStyle]
  /**
   * removes a movie from the stock.
   * @param movie the movie to remove from the stock.
   * @return the number of items of this movie in stock after this operation.
   */
  public int removeFromStock(IMovie movie) {
    Integer i = stock.get(movie.getTitle());
    int inStock = (i == null) ? 0 : i;
    if (inStock <= 0) { throw new MovieRentalException("no video in stock"); }
    stock.put(movie.getTitle(), --inStock);
    notifyListeners(movie, inStock);
    return inStock;
  }
\end{lstlisting}

\begin{lstlisting}[language=Java,caption=Log4j, style=MyJavaStyle]
    public void setReleaseDate(Date aReleaseDate) {
        logger.trace("entering Movie.setReleaseDate");
        if (this.releaseDate != null) {
            IllegalStateException e = new IllegalStateException();
            logger.error("Exception:", e);
            throw e;
        }
        this.releaseDate = aReleaseDate;
        logger.debug("releaseDate: " +  this.releaseDate);
        logger.trace("exiting Movie.setReleaseDate");
    }
\end{lstlisting}

\end{document}